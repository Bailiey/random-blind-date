<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>랜덤 소개팅 - 복권 소개팅</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <p id="admin-trigger" onclick="showAdminPage()">관리자</p>

    <section id="page1" class="page active">
        <h1>✨ 복권 소개팅 ✨</h1>
        <p class="subtitle">파랑 복권집</p>
        <p class="description">
            두근두근 설레는 만남, <br>별빛 같은 수많은 사람들 속에서<br>
            당신을 알아볼 단 한 사람을 뽑아보세요
        </p>
        <div class="button-group">
           <button onclick="startParticipationFlow('1on1')" class="main-button">1:1 소개팅 참여하기</button>
           <button onclick="startParticipationFlow('2on2')" class="main-button">2:2 소개팅 참여하기</button>
        </div>
    </section>

    <section id="page2" class="page">
        <h2>개인정보 수집 및 이용 동의</h2>
        <div class="consent-box">
            <p class="consent-title"><strong>[필수] 개인정보 수집 및 이용 동의</strong></p>
            <p class="consent-details">
                - 수집 목적: 매칭 서비스 제공 및 연락<br>
                - 수집 항목: 단과대학, 학과, 학번 이름, 성별, 전화번호<br>
                - 보유 기간: 축제 종료 후 즉시 파기<br>
                - 동의를 거부할 권리가 있으며, 거부 시 서비스 이용이 제한됩니다.
            </p>
            <div class="checkbox-wrapper">
                <label class="checkbox-container">
                    위 내용을 확인하고 동의합니다.
                    <input type="checkbox" id="consent1">
                    <span class="checkmark"></span>
                </label>
            </div>
        </div>
        <div class="button-group">
            <button onclick="checkConsentAndProceed()" class="proceed-button">다음 단계로</button>
            <button onclick="showPage(1)" class="back-button">비동의 (메인으로)</button>
        </div>
    </section>

    <section id="page3" class="page">
        <h2><strong>매칭 이후 책임 동의 및 환불 정책</strong></h2>
        <div class="consent-box">
            <p>총학생회는 <span class="highlight">매칭 과정</span>까지만 진행하며,
                <br>이후 두 분 사이에서 발생하는 모든 상황에 대해서는
                <br> <span class="highlight">일절 책임이 없다는 점</span>을 안내드립니다.</p>

            <p><strong>환불 불가 안내</strong><br>
                : 결제된 참가비는 <span class="highlight">매칭이 완료되면</span> 어떠한 경우에도 환불이 불가합니다.</p>
            <div class="checkbox-wrapper">
                <label class="checkbox-container">
                    위 내용을 확인하고 동의합니다.
                    <input type="checkbox" id="consent2">
                    <span class="checkmark"></span>
                </label>
            </div>
        </div>
        <div class="button-group">
            <button onclick="checkResponsibilityConsent()" class="proceed-button">다음 단계로</button>
            <button type="button" onclick="showPage(2)" class="back-button">이전으로</button>
        </div>
    </section>

    <section id="page4_1on1" class="page input-form">
        <h2>1:1 복권 소개팅 - 참가자 정보</h2>
        <form id="form1on1">
            <div class="form-group"><label for="lotteryNum1">복권 번호</label><input type="text" id="lotteryNum1" required oninput="filterNonNumeric(event)" placeholder="구매하신 복권 번호를 입력하세요"><p class="warning">숫자만 입력하세요</p></div>
            <div class="form-group">
                <label for="college1">단과대학</label>
                <select id="college1" onchange="updateDepartments('college1', 'dept1')" required>
                    <option value="">선택하세요</option>
                    <option value="간호대학">간호대학</option>
                    <option value="경상대학">경상대학</option>
                    <option value="공과대학">공과대학</option>
                    <option value="국가안보융합학부">국가안보융합학부</option>
                    <option value="국제학부">국제학부</option>
                    <option value="농업생명과학대학">농업생명과학대학</option>
                    <option value="사범대학">사범대학</option>
                    <option value="사회과학대학">사회과학대학</option>
                    <option value="생활과학대학">생활과학대학</option>
                    <option value="생명시스템과학대학">생명시스템과학대학</option>
                    <option value="수의과대학">수의과대학</option>
                    <option value="약학대학">약학대학</option>
                    <option value="예술대학">예술대학</option>
                    <option value="의과대학">의과대학</option>
                    <option value="인문대학">인문대학</option>
                    <option value="자연과학대학">자연과학대학</option>
                    <option value="지식융합학부">지식융합학부</option>
                    <option value="창의융합과학대학">창의융합과학대학</option>
                </select>
            </div>
            <div class="form-group"><label for="dept1">학과</label><select id="dept1" required disabled><option value="">단과대학을 먼저 선택하세요</option></select></div>
            <div class="form-group"><label for="studentId1">학번</label><input type="text" id="studentId1" required oninput="filterNonNumeric(event)" placeholder="학번을 입력하세요 (예: 20231234)"><p class="warning">숫자만 입력하세요</p></div>
            <div class="form-group"><label for="name1">이름</label><input type="text" id="name1" required placeholder="이름을 입력하세요"></div>
            <div class="form-group">
                <label>성별</label>
                <div class="radio-group">
                    <input type="radio" id="gender_m" name="gender" value="남자" required><label for="gender_m">남자</label>
                    <input type="radio" id="gender_f" name="gender" value="여자"><label for="gender_f">여자</label>
                </div>
            </div>
            <div class="form-group">
                <label for="phone1">전화번호</label>
                <input type="tel" id="phone1" required oninput="filterNonNumeric(event)" placeholder="숫자만 입력 (예: 01012345678)">
                <p class="warning">오타 입력 시 환불 불가 및 매칭 불가</p>
            </div>
            <div class="button-group">
                <button type="submit" onclick="submitForm('1on1', event)" class="submit-button">참가 정보 제출</button>
                <button type="button" onclick="showPage(3)" class="back-button">이전으로</button>
            </div>
        </form>
    </section>

    <section id="page5_2on2" class="page input-form">
        <h2>2:2 복권 소개팅 - 참가자 정보</h2>
        <form id="form2on2">
            <div class="form-group"><label for="lotteryNum2">복권 번호</label><input type="text" id="lotteryNum2" required oninput="filterNonNumeric(event)" placeholder="구매하신 복권 번호를 입력하세요"><p class="warning">숫자만 입력하세요</p></div>
            <div class="form-group">
                <label>성별 (팀 전체 성별 선택)</label>
                <div class="radio-group">
                    <input type="radio" id="gender2_m" name="gender2" value="남자팀" required><label for="gender2_m">남자팀</label>
                    <input type="radio" id="gender2_f" name="gender2" value="여자팀"><label for="gender2_f">여자팀</label>
                </div>
            </div>
            <hr style="margin: 30px 0; border-top: 1px dashed #DAA520;">

            <h3>참가자 1</h3>
            <div class="form-group"><label for="2-1_college">단과대학</label>
                <select id="2-1_college" onchange="updateDepartments('2-1_college', '2-1_dept')" required>
                    <option value="">선택하세요</option>
                    <option value="간호대학">간호대학</option>
                    <option value="경상대학">경상대학</option>
                    <option value="공과대학">공과대학</option>
                    <option value="국가안보융합학부">국가안보융합학부</option>
                    <option value="국제학부">국제학부</option>
                    <option value="농업생명과학대학">농업생명과학대학</option>
                    <option value="사범대학">사범대학</option>
                    <option value="사회과학대학">사회과학대학</option>
                    <option value="생활과학대학">생활과학대학</option>
                    <option value="생명시스템과학대학">생명시스템과학대학</option>
                    <option value="수의과대학">수의과대학</option>
                    <option value="약학대학">약학대학</option>
                    <option value="예술대학">예술대학</option>
                    <option value="의과대학">의과대학</option>
                    <option value="인문대학">인문대학</option>
                    <option value="자연과학대학">자연과학대학</option>
                    <option value="지식융합학부">지식융합학부</option>
                    <option value="창의융합과학대학">창의융합과학대학</option>
                </select>
            </div>
            <div class="form-group"><label for="2-1_dept">학과</label><select id="2-1_dept" required disabled><option value="">단과대학을 먼저 선택하세요</option></select></div>
            <div class="form-group"><label for="2-1_studentId">학번</label><input type="text" id="2-1_studentId" required oninput="filterNonNumeric(event)" placeholder="학번을 입력하세요 (예: 20231234)"><p class="warning">숫자만 입력하세요</p></div>
            <div class="form-group"><label for="2-1_name">이름</label><input type="text" id="2-1_name" required placeholder="첫 번째 참가자 이름"></div>
            <div class="form-group"><label for="2-1_phone">전화번호</label><input type="tel" id="2-1_phone" required oninput="filterNonNumeric(event)" placeholder="숫자만 입력 (예: 01012345678)"><p class="warning">오타 입력 시 환불 불가 및 매칭 불가</p></div>
            <hr style="margin: 30px 0; border-top: 1px dashed #DAA520;">

            <h3>참가자 2</h3>
            <div class="form-group"><label for="2-2_college">단과대학</label>
                <select id="2-2_college" onchange="updateDepartments('2-2_college', '2-2_dept')" required>
                    <option value="">선택하세요</option>
                    <option value="간호대학">간호대학</option>
                    <option value="경상대학">경상대학</option>
                    <option value="공과대학">공과대학</option>
                    <option value="국가안보융합학부">국가안보융합학부</option>
                    <option value="국제학부">국제학부</option>
                    <option value="농업생명과학대학">농업생명과학대학</option>
                    <option value="사범대학">사범대학</option>
                    <option value="사회과학대학">사회과학대학</option>
                    <option value="생활과학대학">생활과학대학</option>
                    <option value="생명시스템과학대학">생명시스템과학대학</option>
                    <option value="수의과대학">수의과대학</option>
                    <option value="약학대학">약학대학</option>
                    <option value="예술대학">예술대학</option>
                    <option value="의과대학">의과대학</option>
                    <option value="인문대학">인문대학</option>
                    <option value="자연과학대학">자연과학대학</option>
                    <option value="지식융합학부">지식융합학부</option>
                    <option value="창의융합과학대학">창의융합과학대학</option>
                </select>
            </div>
            <div class="form-group"><label for="2-2_dept">학과</label><select id="2-2_dept" required disabled><option value="">단과대학을 먼저 선택하세요</option></select></div>
            <div class="form-group"><label for="2-2_studentId">학번</label><input type="text" id="2-2_studentId" required oninput="filterNonNumeric(event)" placeholder="학번을 입력하세요 (예: 20231234)"><p class="warning">숫자만 입력하세요</p></div>
            <div class="form-group"><label for="2-2_name">이름</label><input type="text" id="2-2_name" required placeholder="두 번째 참가자 이름"></div>
            <div class="form-group"><label for="2-2_phone">전화번호</label><input type="tel" id="2-2_phone" required oninput="filterNonNumeric(event)" placeholder="숫자만 입력 (예: 01012345678)"><p class="warning">오타 입력 시 환불 불가 및 매칭 불가</p></div>

            <div class="button-group">
                <button type="submit" onclick="submitForm('2on2', event)" class="submit-button">참가 정보 제출</button>
                <button type="button" onclick="showPage(3)" class="back-button">이전으로</button>
            </div>
        </form>
    </section>

    <section id="page6" class="page">
        <h1>🎉 참가 완료!</h1>
        <p class="description">당신의 복권 번호와 함께 매칭 결과를 기다려주세요.<br>성공적인 만남을 기원합니다!</p>
        <button onclick="showPage(1)" class="main-button">메인으로 돌아가기</button>
    </section>

    <section id="adminPage" class="page admin-view">
        <h2>관리자 데이터 다운로드</h2>
        <input type="password" id="adminPassword" placeholder="관리자 비밀번호">
        <button onclick="checkAdminPassword()">로그인</button>

        <div id="downloadArea" style="display:none;">
            <p>로그인 성공! 아래 버튼으로 데이터를 다운로드하세요.</p>
            <button onclick="downloadData('1on1')">1:1 데이터 다운로드 (Excel)</button>
            <button onclick="downloadData('2on2')">2:2 데이터 다운로드 (Excel)</button>

            <hr style="margin-top: 20px; border-color: #ddd;">
            <button onclick="confirmResetData()" class="back-button">누적 데이터 초기화</button>
        </div>

        <div class="button-group">
            <button onclick="showPage(1)" class="back-button">메인 페이지로 이동</button>
        </div>
    </section>

    <div id="paymentPopupOverlay" class="popup-overlay">
        <div class="popup-content">
            <h3>참가비 입금 안내</h3>
            <div class="account-info">
                <p><strong>은행:</strong> 하나은행</p>
                <p><strong>예금주:</strong> 장준우</p>
                <p><strong>계좌번호:</strong> 0000-00-000000</p>
                <p><strong>금액:</strong> 인당 3,000원</p>
            </div>
            <p class="popup-explanation"><span class="highlight">입금 후, 관계자에게 입금 내역을 보여주세요.</span></p>
            <div class="button-group">
                <button onclick="showStudentIdPopup()" class="proceed-button">확인했어요</button>
                <button onclick="closePopup('paymentPopupOverlay')" class="back-button">취소</button>
            </div>
        </div>
    </div>

    <div id="studentIdPopupOverlay" class="popup-overlay">
        <div class="popup-content">
            <h3>학생증 확인 안내</h3>
            <p class="popup-explanation">
                <strong>관계자에게 학생증을 보여주세요.</strong><br><br>
                * 실물 학생증, 모바일 학생증 모두 가능<br>
                * 캡쳐본 불가 (모바일의 경우 충남대학교 어플 사용)
            </p>
            <div class="button-group">
                <button onclick="proceedToConsent()" class="proceed-button">확인했어요</button>
                <button onclick="closePopup('studentIdPopupOverlay')" class="back-button">취소</button>
            </div>
        </div>
    </div>

    <div id="refundPopupOverlay" class="popup-overlay">
        <div class="popup-content">
            <div class="chat-bubble-image">
                <p>상대방이 매칭 이후<br>아무 말 없이 나갔어요.</p>
            </div>
            <p class="popup-message">이와 같은 경우에도 환불이 불가합니다.</p>
            <div class="button-group">
                <button onclick="showMatchingLogicPopup()" class="proceed-button">확인</button>
                <button onclick="closePopup('refundPopupOverlay')" class="back-button">취소</button>
            </div>
        </div>
    </div>

    <div id="matchingLogicPopupOverlay" class="popup-overlay">
        <div class="popup-content">
            <h3>매칭 원칙 안내</h3>
            <p class="popup-explanation">
                매칭은 <span class="highlight">동일한 복권 번호</span>를 구매한 
                <br>남녀 간의 연결을 원칙으로 합니다.
                <br><br>
                다만, 축제 종료 후 성별에 따른 복권 판매량이 일치하지 않을 경우, 
                <br>모든 분들의 매칭을 위해 부득이하게 제출 순서에 따라 <br>
                <strong>순차적</strong>으로 매칭이 진행될 수 있습니다.
                <br><br>
                이 경우, <strong>구매하신 복권 번호와 다른 번호의 상대</strong>와 
                <br>연결될 수 있는 점 미리 양해 부탁드립니다.
            </p>
            <div class="button-group">
                <button onclick="finalConfirmAndProceed()" class="proceed-button">모두 동의 및 진행</button>
                <button onclick="closePopup('matchingLogicPopupOverlay')" class="back-button">취소</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>